docno="lists-001-0678141"
received="Thu Oct 26 13:09:50 2000"
isoreceived="20001026170950"
sent="Thu, 26 Oct 2000 12:38:55 -0400 (EDT)"
isosent="20001026163855"
name="Markus Hoenicka"
email="Markus.Hoenicka@uth.tmc.edu"
subject="[fixed] odd behaviour with &lt;/script&gt;"
id="14840.24565.832000.367200@gargle.gargle.HOWL"
charset="us-ascii"
expires="-1"


To:html-tidy@w3.org,dsr@w3.org

The following patch fixes a bug in tidy which prevents it from
regognizing </script> end tags if they contain whitespace as in:
</script
>

It apparently does not screw up anything else, but I didn't test this
thoroughly.

For a test case, see my previous post:
http://lists.w3.org/Archives/Public/html-tidy/2000OctDec/0055.html

-------------------------------------------
--- lexer.c.origFri Aug  4 16:21:05 2000
+++ lexer.cThu Oct 26 16:23:44 2000
@@ -1381,13 +1381,21 @@
         }
         else if (c == '\r')
         {
+  if (endtag) {
+    continue; /* discard whitespace in endtag */
+  }
+  else {
             c = ReadChar(lexer->in);
 
             if (c != '\n')
                 UngetChar(c, lexer->in);
 
             c = '\n';
+  }
         }
+else if ((c == '\n' || c == '\t' || c == ' ') && endtag) {
+  continue; /* discard whitespace in endtag */
+}
 
         AddCharToLexer(lexer, (uint)c);
         lexer->txtend = lexer->lexsize;
-------------------------------------------

regards,
Markus

-- 
Markus Hoenicka, PhD
UT Houston Medical School
Dept. of Integrative Biology and Pharmacology
6431 Fannin MSB4.114
Houston, TX 77030
(713) 500-6313, -7477
(713) 500-7444 (fax)
Markus.Hoenicka@uth.tmc.edu
http://ourworld.compuserve.com/homepages/hoenicka_markus/



