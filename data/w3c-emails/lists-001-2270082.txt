docno="lists-001-2270082"
received="Tue Dec  5 15:14:01 2000"
isoreceived="20001205201401"
sent="Tue, 5 Dec 2000 15:13:38 -0500 "
isosent="20001205201338"
name="Reitzel, Charlie"
email="CReitzel@arrakisplanet.com"
subject="[BUG+FIX] cleaning list bullets for Word 2000"
id="B5C79DDBC655D311B6BD0008C7E64D7685C538@exchange.arrakisplanet.com"
charset="iso-8859-1"
expires="-1"


To:"'html-tidy@w3.org'"<html-tidy@w3.org>

Sorry, forgot the sample files.

When converting paragraphs w/ the class="MsoListBullet" attribute to <ul>
<li></li> ... </ul>, Tidy always leaves the second item out of the list and
it appears as the following paragraph.  A sample input file
(word2k_list.html) and output file (work2k_tidy.html) are attached.

The fix is to the CleanWord2000() routine in clean.c:

C:\tidy\TidyLib>diff -w -c1 c:\temp\clean.c  .\clean.c
*** c:\temp\clean.c     Tue Dec 05 18:57:59 2000
--- .\clean.c   Tue Dec 05 19:21:45 2000
***************
*** 1805,1807 ****
                  InsertNodeAtEnd(list, node);
!                 node = list->next;
              }
--- 1805,1807 ----
                  InsertNodeAtEnd(list, node);
!                 node = list;
              }

The effect of the change is to avoid Purging the attributes of the second
item of the list before the class=MsoListBullet test can be applied.  This
change takes effect at the bottom of the containing loop.






application/octet-stream attachment: tidy.cfg

text/html attachment: word2k_list.html

text/html attachment: word2k_tidy.html




