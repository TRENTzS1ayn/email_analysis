docno="lists-001-3861672"
received="Thu Apr 19 20:40:32 2001"
isoreceived="20010420004032"
sent="Thu, 19 Apr 2001 01:48:42 -0400 (EDT)"
isosent="20010419054842"
name="Huajun Zeng"
email="i-hjzeng@microsoft.com"
subject="Re: Exception: access violation (0xc0000005), Address: 0x004031ec"
id="F4C77846CEE593418BE5AB7B6A83111E0377F98A@bjs-msg-01.fareast.corp.microsoft.com"
charset="us-ascii"
inreplyto="Exception: access violation (0xc0000005), Address: 0x004031ec"
expires="-1"


To:<html-tidy@w3.org>

I got the same error when I work with tidy. Then I traced the program,
and found some code may contains bugs.

In function WrapLine in pprint.c:
...
    if (linelen > wraphere)
    {
        p = linebuf;
        if (linebuf[wraphere] == ' ')
            ++wraphere;
        q = linebuf + wraphere;
        AddC('\0', linelen);
        while ((*p++ = *q++));
        linelen -= wraphere;
    }
...

The function AddC not only add a char to the buffer, but also can
reallocate mem for linebuf. In this case, p and q point to a memory
block that has been released. The released memory block still can be
accessed, but it is not zero ended. So the while cycle carries the
pointers to some mystic area...



