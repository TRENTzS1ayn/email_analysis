docno="lists-006-12222996"
received="Mon Aug 20 17:38:36 2001"
isoreceived="20010820213836"
sent="Mon, 20 Aug 2001 22:36:49 +0100"
isosent="20010820213649"
name="Peter Raymond"
email="Peter.Raymond@merant.com"
subject="Re: Versions being deleted during a MERGE..."
id="3B8182F1.3F7CE660@merant.com"
charset="us-ascii"
inreplyto="3B8162DA.39C8D357&#64;merant.com"
expires="-1"


To:"Clemm, Geoff"<gclemm@rational.com>,ietf-dav-versioning@w3.org


Peter Raymond wrote:

> Hi,
>
> "Clemm, Geoff" wrote:
>
> > A server is of course free to refuse the DELETE request,
> > and indicate as its reason that it didn't want to satisfy
> > the postcondition that would remove that version URL from
> > the DAV:merge-set.
> >
>
> I thought the servers (to be compliant) MUST enforce the postconditions.
> Are you saying a deltav compliant server needs not honour all the
> postconditions?  If servers do not honour the postconditions would it not
> lead to possible non-interoperability?
>

Apologies...ignore that bit above....I just realized that since I want the
DELETE to
fail it is fine to fail one of the postconditions (and as Geoff says return the
reason
in the response).  It's only when the operation is successful that all the
postconditions
must be honoured.

>
> >
> > Note thought that even if the server allows the deletion,
> > there is no race condition here, though,
> > just some dangling version URL's that will return 404's
> > when accessed.
> >
>
> The condition I was thinking of was when client A issues the MERGE request
> (which checks-out the VCR) but after getting the HTTP response for the
> query for
> the checked-out resources DAV:merge-set client B deletes one of the
> versions
> referenced in that set.  Client A then goes on to do a GET (for example) to
> retrieve
> the content to be merged but it would fail (with a 404).....client B's
> DELETE got there
> first!
>
> I guess I would implement Tims idea and lock down all the resources before
> beginning the interactive merge.
>
> Also I just noticed that in section 11.2 we define merged-set, updated-set,
>
> and ignored-set but the example in section 11.2.1 has <D:update-set> etc
> not <D:updated-set> etc.
>
> Regards,
> Peter Raymond - MERANT.
>
> >
> > Cheers,
> > Geoff
> >
> > -----Original Message-----
> > From: Peter Raymond [mailto:Peter.Raymond@merant.com]
> > Sent: Sunday, August 19, 2001 8:22 AM
> > To: ietf-dav-versioning@w3.org
> > Subject: Versions being deleted during a MERGE...
> >
> > Hi,
> >
> > I just noticed a potential problem with versions being used for a merge
> > operation
> > being deleted during the merge.
> >
> > Section 11 says a checked-out resource has a DAV:merge-set identifying
> > versions
> > to be merged.  DELETE (section 11.5) says it will remove entries from
> > the
> > merge-set.  Shouldn't the server disallow the DELETE, someone somewhere
> > is in the
> > middle of a merge using this version, also there would be a race
> > condition if someone
> > deletes the version while the client is processing the DAV:merge-set of
> > a checked-out
> > resource.
> >
> > Regards,
> > Peter Raymond - MERANT



