docno="lists-010-15138318"
received="Tue Mar 18 10:04:02 1997"
isoreceived="19970318150402"
sent="Tue, 18 Mar 1997 15:31:49 +0100 (MET)"
isosent="19970318143149"
name="Balint Nagy Endre"
email="bne@carenet.hu"
subject="Re: Fact-checking: do any inservice proxy caches ever ignore Expires?"
id="2046.bne@CareNet.hu"
inreplyto="9703180039.AA13302&#64;acetes.pa.dec.com"
expires="1"

To: Jeffrey Mogul<mogul@pa.dec.com>
Cc:http-wg@cuckoo.hpl.hp.com,squid-dev@nlanr.net


> but ...
> >From Anthony Baxter <arb@connect.com.au>
>     squid allows you to force certain pages to not be expired for certain
>     amount of time. This is useful for, eg www.realaudio.com, who set all
>     their pages to expire 'now' (well, they used to, anyway).
>     
> "Kolics Bertold, University of Veszprem" <bertold@tohotom.vein.hu>
>     It *is* possible in Squid-1.1.x.
>     Excerpt from the Release-Notes:
> "Squid 1.1 switched from a Time-To-Live based expiration model
> to a Refresh-Rate model.  Objects are no longer purged from the
> cache when they expire.  Instead of assigning TTL's when the
> object enters the cache, we now check freshness requirements
> when objects are requested."
>     Minimum age can be given for specific URL patterns. By default it is set
>     to zero for all URL patterns, but for cache-unfriendly sites it is usually
>     changed...
> 
> So I am still a little confused about whether Squid simply lets stuff
> stay in the cache past the Expires time, or whether it always checks
> past-Expires responses with the origin server before providing them.
> Kolics Bertold's quote from the Squid 1.1 release notes implies (but
> does not specifically state) that Squid *always* checks freshness;
> Anthony Baxter's comments implies (but not specifically state) the
> opposite.
Squids refresh_pattern directive overrides expiration from the response,
that's squid never contact origin servers before the min-age parameter.
If someone specifies a non-zero min age, squid violates the spec.
I would be satisfied, if min-age and max-age specified in refresh_pattern
have effect only if Expires and cache-control max-age is absent in the
response - in sync with the spec.
However, an overriding version of refresh_pattern would be useful too,
because of human lousiness we still see too much pre-expired pages, or
pages lacking Last-modified and content-length. I really hate to see such pages,
but how current proxies handle Cache-Control: must-revalidate? 
Squid honors Cache-Control: must-revalidate - the proper (http/1.1)
way to count hits and do dynamic html etc.
> Sorry about the confusing language the first time I sent this.
> 
> -Jeff
> 
Andrew. (Endre "Balint" Nagy) <bne@CareNet.hu> <bne@bne.ind.eunet.hu>



