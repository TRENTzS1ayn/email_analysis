docno="lists-011-16512719"
received="Wed Feb  4 21:11:06 1998"
isoreceived="19980205021106"
sent="Thu, 5 Feb 1998 06:05:16 +0200"
isosent="19980205040516"
name="Life is hard... and then you die."
email="Ronald.Tschalaer@psi.ch"
subject="Re: proposed solution for CONTENTLENGTH"
id="98020506051638@psiclb.psi.ch"
inreplyto="proposed solution for CONTENTLENGTH"
expires="1"


To:MOGUL@pa.dec.com,HTTP-WG@cuckoo.hpl.hp.com


> On Tue, 03 Feb 98, Jeffrey Mogul (mogul@pa.dec.com) wrote:
> 
[snip]
> The following edits are based on draft-ietf-http-v11-spec-rev-01.txt,
> which you might need to refer to when reviewing these edits.

Looks good to me. I have one question, though.

> (2) In section 4.4 (Message Length), insert at the beginning:
>         The transfer-length of a message is the length of the
>         message-body as it appears in the message; that is, after any
>         transfer codings have been applied.
[snip]
> Change
>          3. If a Content-Length header field (section 14.14) is
>          present, its decimal value in OCTETs represents the length of
>          the message-body.
> To
>          3. If a Content-Length header field (section 14.14) is
>          present, its decimal value in OCTETs represents both the
>          entity-length and the transfer-length.  The Content-Length
>          header field MUST NOT be used if these two lengths are
>          different (i.e., if a Transfer-Encoding header field is
>          present).
[snip]
> Change
>        Messages MUST NOT include both a Content-Length header field and
>        the "chunked" transfer coding. If both are received, the
>        Content-Length MUST be ignored.
> To
>        Messages MUST NOT include both a Content-Length header field and
>        a non-identity transfer coding.  If the message does include
>        a non-identity transfer code, the Content-Length header field
>        MUST be ignored.

I'm not particular about this, but is there a specific reason why the
Content-Length header must not be sent with a non-identity t-e? I just
think it might be useful for a recipient if it can pre-allocate a
buffer of the correct size (assuming no Content-Encoding was applied).
I think the rules are clear that the Content-Encoding should not be
used to determine the length of the entity (i.e. the transfer length)
when a non-identity t-e is present, and I can't see any compatibility
problems with older clients (they don't send the TE header), so I don't
see what harm the Content-length header would do (apart from adding a
few extra bytes to the headers).


  Cheers,

  Ronald



