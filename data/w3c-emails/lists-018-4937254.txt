docno="lists-018-4937254"
received="Mon Aug 11 06:12:57 2003"
isoreceived="20030811101257"
sent="Mon, 11 Aug 2003 12:12:40 +0200"
isosent="20030811101240"
name="Kay, Michael"
email="Michael.Kay@softwareag.com"
subject="RE: MS-FO-LC1-100: Promotion of untyped values in fn:distinctval ues?"
id="DFF2AC9E3583D511A21F0008C7E62106073DD051@daemsg02.softwareag.de"
inreplyto="MS-FO-LC1-100: Promotion of untyped values in fn:distinctval ues?"
expires="1"


To: Ashok Malhotra<ashokma@microsoft.com>, Michael Rys<mrys@microsoft.com>,public-qt-comments@w3.org

> fn:distinct-values does not say how values of type 
> xdt:untypedAtomic are handled.  I suggest we use the same 
> rule that we use for aggregate functions, namely  "Values of 
> type xdt:untypedAtomic are cast to the type of the other 
> items in $arg. If all values in $arg are of type 
> xdt:untypedAtomic they are converted to xs:string."

But we have other threads that point out that this is a really bad rule,
because it prevents a pipelined implementation. It must be possible to
process untypedAtomic values without looking ahead to discover the types of
all other items in the sequence. This means that each aggregate function
must have a "default type", and untypedAtomic values should be converted to
the default type. For fn:distinct-values, the only sensible default type is
string.

Michael Kay



