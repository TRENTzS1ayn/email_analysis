docno="lists-023-11192255"
received="Wed Oct  8 22:03:11 2003"
isoreceived="20031009020311"
sent="Wed, 8 Oct 2003 19:01:39 -0700 (PDT)"
isosent="20031009020139"
name="Andrew Wason"
email="rectalogic@yahoo.com"
subject="Re: Working around plugin prompt in IE6SP1b cleanly (ish)"
id="20031009020139.2696.qmail@web20909.mail.yahoo.com"
charset="us-ascii"
inreplyto="Working around plugin prompt in IE6SP1b cleanly (ish)"
expires="-1"


To:public-web-plugins@w3.org


> It is possible to work around the plugin prompt in
> the new IE6 update in a standards-compliant and
> backwards compatible way. 

Here is what I have been using to support Flash. It's
backwards compatible with Netscape 4.x and IE 4.x and
others.

I use noexternaldata="true" to avoid the prompt, and
then set the external data source via script if this
is the updated IE6. According to MS documentation "The
properties of a control loaded with an OBJECT element
can also be set in script. If a remote source of data
is provided to a control in script, the user is not
prompted when the control loads."

The only problem is the IE6 update does not include
the AXCompat string in the userAgent as the MS docs
say it will: "Note: You can determine if a user's
version of Internet Explorer exhibits the new behavior
by examining the user agent string. If it contains the
token AXCompat, then the browser has the new
behavior."

So I commented that test out for now.

Making this registry entry fixes IE6 so it has
AXCompat in the userAgent. The xpsp2res.dll included
with the update is attempting to insert this registry
entry in the wrong place.

Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet
Settings\User Agent\Post Platform]
"AXCompat"="AXCompat"


<html>
<body>
<object id="flash" noexternaldata="true"
classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"

codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=4,0,0,0"
width="320" height="300">
<param name="movie" value="test.swf">
<embed src="test.swf"
width="320"
height="300"
type="application/x-shockwave-flash"

pluginspage="http://www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash"
>
</embed>
</object>
<script language="JavaScript">
// Comment out if IE6 is broken and doesn't contain
AXCompat
//if (navigator.userAgent.indexOf("AXCompat") != -1)
flash.Movie = "test.swf";
</script>
</body>
</html>



Andrew

__________________________________
Do you Yahoo!?
The New Yahoo! Shopping - with improved product search
http://shopping.yahoo.com



