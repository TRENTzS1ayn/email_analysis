docno="lists-039-5630158"
received="Sun Jul 11 11:32:54 1999"
isoreceived="19990711153254"
sent="Sun, 11 Jul 1999 08:31:25 -0700"
isosent="19990711153125"
name="Yaron Goland (Exchange)"
email="yarong@Exchange.Microsoft.com"
subject="RE: [Moderator Action] LOCK and Office 2000"
id="078292D50C98D2118D090008C7E9C6A601947361@STAY.platinum.corp.microsoft.com"
charset="iso-8859-1"
inreplyto="[Moderator Action] LOCK and Office 2000"
expires="-1"


To:"'Jim Whitehead'"<ejw@ics.uci.edu>, Jeff Baker<JBaker@novell.com>,w3c-dist-auth@w3.org

1. I will forward that bug.
2. Did you try to return a timeout value of infinity?
3. The BNF in section 6.4 allows for extension information.

I don't think #3 is the problem since I think Office treats the lock token
as a string. #2 sounds like the top contender to me. I would just change the
response to include the timeout value and see if that works. If you have a
netmon trace please send it to me. Also, if you have a server location I can
test against that would also be useful.

Yaron

> -----Original Message-----
> From: Jim Whitehead [mailto:ejw@ics.uci.edu]
> Sent: Sunday, July 11, 1999 12:39 AM
> To: Jeff Baker; w3c-dist-auth@w3.org
> Subject: RE: [Moderator Action] LOCK and Office 2000
> 
> 
> 
> Nothing is immediately jumping to my mind.  It might be 
> helpful if you could
> post a protocol trace. Since you've tried to address these 
> problems and it
> hasn't worked, perhaps the problem lies someplace else.
> 
> - Jim
> 
> > I'm having trouble getting Office 2000 to believe our Novell
> > NetPublisher server when it says that a document is locked: I
> > open a Web folder file and it always opens read-only. I've
> > sniffed our response to the lock and compared it with Microsoft's
> > (IIS 5 on Jim Whitehead's UCI machine). There are three differences:
> >
> > 1) Office 2000 doesn't specify a depth; the WebDAV spec says that
> > "If no Depth header is submitted on a LOCK request then the
> > request MUST act as if a "Depth:infinity" had been submitted."
> > Because of this sentence in the spec, we return a lock of depth
> > infinity; IIS 5 returns a lock of depth 0.
> >
> > 2) Office 2000 requests and receives a timeout of "Second-120"
> > from IIS 5. Our server doesn't (yet) support timeouts, so we
> > don't include a timeout XML element in the response.
> >
> > 3) The lock token from IIS 5 differs from tokens specified in the
> > spec. One attempt to lock returned the token
> > "opaquelocktoken:AA9F6414-1D77-11D3-B825-00105A989226:214748364853
> > " The decimal digits after the last colon are not defined in the
> > UUID spec (ISO-11578) as far as I've been able to determine.
> >
> > I've tried changing the server code to more closely match IIS's
> > response, in each of these three ways (depth, timeout,
> > locktoken). In all three cases, Office 2000 still opened the file
> > read-only. My gut says that case 3) above is what's causing the
> > problem, but I don't know what it is that IIS puts, or what
> > Office 200 wants, in this value.
> >
> > Does anybody have any information about this?
> >
> > jbaker@novell.com
> >
> 



