docno="lists-041-2899752"
received="Wed May 29 10:14:30 2002"
isoreceived="20020529141430"
sent="Wed, 29 May 2002 07:13:53 -0700"
isosent="20020529141353"
name="Jim Luther"
email="luther.j@apple.com"
subject="Re: Lightweight PROPFIND requests"
id="4E1E5704-730E-11D6-B08A-0003934B6A22@apple.com"
charset="US-ASCII"
inreplyto="3906C56A7BD1F54593344C05BD1374B10704C05F&#64;SUS-MA1IT01"
expires="-1"

To:w3c-dist-auth@w3.org



No, I didn't test DELETE with Depth: 0 because (as Geoff also pointed 
out) RFC 2518 says "A client MUST NOT submit a Depth header with a 
DELETE on a collection with any value but infinity."

- Jim

On Wednesday, May 29, 2002, at 05:20 AM, Clemm, Geoff wrote:
>
> Good point Stefan.  Unfortunately, this use case was not
> something the writers of 2518 thought of, and they explicitly
> disallowed the use of a non-Infinity Depth header for DELETE.
>
> We should add this to the list of features we'd like to add/change
> in RFC 2518.
>
> Cheers,
> Geoff
>
> -----Original Message-----
> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
> Sent: Wednesday, May 29, 2002 7:31 AM
> To: Jim Luther
> Cc: w3c-dist-auth@w3.org
> Subject: Re: Lightweight PROPFIND requests
>
> That of course opens the question why DELETE on a collection
> with Depth: 0 is forbidden. There seems to be a use case
> for this and it is easy for a server to implement.
>
> Jim, did you make any tests how servers respond to a Depth: 0
> DELETE request?
>
> //Stefan
>
> Am Mittwoch den, 29. Mai 2002, um 03:18, schrieb Jim Luther:
>
>> There are a few times when the Mac OS X WebDAV file system client
>> needs to use the PROPFIND method with "Depth: 1" on a collection
>> resource to determine if it contains any children resources. For
>> example, POSIX requires that my rmdir code must not delete a
>> directory (collection) unless it is empty. Since the WebDAV DELETE
>> method doesn't work that way (it deletes all children), my code
>> uses the PROPFIND method with "Depth: 1" to determine if the
>> DELETE method can be called on the empty collection, or if
>> ENOTEMPTY should be returned because the collection has children.
>> I don't need any properties from that PROPFIND, just the list of
>> children.
>>
>> I tried this:
>>
>> <?xml version="1.0" encoding="utf-8"?>
>> <D:propfind xmlns:D="DAV:">
>> <D:prop>
>> </D:prop>
>> </D:propfind>
>>
>> and it works with mod_dav. However (and this is my question), is
>> this legal by the rule <!ELEMENT prop ANY>? I looked through the
>> XML docs to see how ANY was defined but couldn't tell it allowed
>> an empty set.
>>
>> If that's illegal and I must I ask for at least one property, I'll
>> just ask for the resourcetype property since it looks like the
>> only property that MUST be defined for all DAV compliant resources
>> (all of the other DAV properties are shoulds, or are MUSTs under
>> certain conditions).
>>
>> Thanks,
>>
>> - Jim Luther



