docno="lists-092-15478764"
received="Wed Apr 21 03:39:58 2004"
isoreceived="20040421073958"
sent="Wed, 21 Apr 2004 09:19:23 +0200"
isosent="20040421071923"
name="Irene Vatton"
email="irene.vatton@inrialpes.fr"
subject="Re: Changes needed to build on AIX 4.1"
id="20040421091923.0cfeb55a.irene.vatton@inrialpes.fr"
charset="ISO-8859-1"
inreplyto="200404082046.i38KkC1P026642&#64;bluegill.adi.com"
expires="-1"

To:schulz@adi.com(Thomas Schulz)
Cc:www-amaya-dev@w3.org



Hi Thomas,

Thanks a lot for this complete information and the work done.
I'll integrate theses patches to make the work easier in the future.

On Thu, 8 Apr 2004 16:46:12 -0400 (EDT)
schulz@adi.com (Thomas Schulz) wrote:

> 
> Following are the changes I made to amaya to get it to compile on an
> AIX 4.1 system using gcc 3.3.2.
> 
> NOTE that most of these changes would not be needed on later versions of AIX.
> You may not want to bother with these as AIX 4.1 is a very old system.
> NOTE that these changes are not in a form that you could use directly.  Most
> would need to be conditional on AIX 4.1
> 
> ----  Amaya/tools/mkdep/mkdep.c ---- Probably needed on all systems ----
> 
> > diff mkdep.c.orig mkdep.c         
> 388c388
> <         mmap_map = malloc(mmap_mapsize);
> ---
> >         mmap_map = (char *)malloc(mmap_mapsize);
> 
> 
> ----------------- Amaya/amaya/XPointer.c ------------------------------
> 
> > diff XPointer.c.orig XPointer.c     
> 717c717,718
> <           snprintf (buffer, sizeof (buffer),
> ---
> > /*        snprintf (buffer, sizeof (buffer), /* snprintf not on AIX 4.1 /*
> >           sprintf (buffer,
> 720c721,722
> <           snprintf (buffer, sizeof (buffer),
> ---
> > /*        snprintf (buffer, sizeof (buffer), */
> >           sprintf (buffer,
> 735c737,738
> <       snprintf (buffer, sizeof (buffer),
> ---
> > /*      snprintf (buffer, sizeof (buffer), */
> >       sprintf (buffer,
> 
> 
> ---------------  Amaya/amaya/AHTURLTools.c --------------------------
> 
> diff AHTURLTools.c.orig AHTURLTools.c
> 2412a2413
> > #define uint64_t unsigned long long int
> 
> 
> ---------------- Amaya/annotlib/ANNOTevent.c -------------------------
> 
> > diff ANNOTevent.c.orig ANNOTevent.c     
> 586c586,587
> <          snprintf (buffer, sizeof (buffer), "%s: %s", TtaGetMessage (AMAYA, AM_ANNOT_INDEX_FAILURE), ptr);
> ---
> > /*       snprintf (buffer, sizeof (buffer), "%s: %s", TtaGetMessage (AMAYA, AM_ANNOT_INDEX_FAILURE), ptr); /* not available on AIX 4.1 */
> >          sprintf (buffer, "%s: %s", TtaGetMessage (AMAYA, AM_ANNOT_INDEX_FAILURE), ptr);
> 1203c1204,1205
> <          snprintf (buffer, sizeof (buffer), "%s: %s", TtaGetMessage (AMAYA, AM_ANNOT_POST_FAILURE), ptr);
> ---
> > /*       snprintf (buffer, sizeof (buffer), "%s: %s", TtaGetMessage (AMAYA, AM_ANNOT_POST_FAILURE), ptr); /* not available on AIX 4.1 */
> >          sprintf (buffer, "%s: %s", TtaGetMessage (AMAYA, AM_ANNOT_POST_FAILURE), ptr);
> 1774c1776,1777
> <          snprintf (buffer, sizeof (buffer), "%s: %s", TtaGetMessage (AMAYA, AM_ANNOT_DELETE_FAILURE), ptr);
> ---
> > /*       snprintf (buffer, sizeof (buffer), "%s: %s", TtaGetMessage (AMAYA, AM_ANNOT_DELETE_FAILURE), ptr); /* not available on AIX 4.1 */
> >          sprintf (buffer, "%s: %s", TtaGetMessage (AMAYA, AM_ANNOT_DELETE_FAILURE), ptr);
> 
> 
> --- Amaya/thotlib/include/sysdep.h --- Probably needed by later versions too---
> 
> 1> diff sysdep.h.orig sysdep.h     
> 795c795
> < #ifndef _AIX
> ---
> > #ifndef _AIXglorp /* AIX 4.1 needs strings.h to define strncasecmp */
> 
> 
> --------------------- Amaya/thotlib/internals/h/thot_key.h  ----------------
> 
> > diff thot_key.h.orig thot_key.h     
> 81c81,82
> < #define THOT_KEY_TAB            XK_ISO_Left_Tab
> ---
> > #define THOT_KEY_TAB            XK_ISO_Left_Tab /* not defined in AIX 4.1 */
> > #define XK_ISO_Left_Tab         0xFE20          /* from AIX 4.3.2 keysymdef.h */
> 
> 
> ------------------- Amaya/thotlib/unicode/ustring.c -------------------
> 
> diff ustring.c.orig ustring.c     
> 353a354
> > /* Can not do this on AIX 4.1.  wcsstr does not exist.
> 354a356,357
> >    As we are unlikely to need the wide character stuff, just return null */
> >   return NULL;
> 
> 
> ---------- Amaya/aix/batch/Makefile --- remove an extra space ------
> 
> diff Makefile.orig Makefile     
> 14c14
> < LIBS  = -L ../thotlib/ -lThotKernel  
> ---
> > LIBS  = -L../thotlib/ -lThotKernel  
> 
> 
> ------------ Amaya/aix/Options  -----------------------
> 
> > diff Options.orig Options
> 52,53c52,53
> < GTK_INCLUDES=-I/usr/local/include/gtk-1.2 -I/usr/local/include/glib-1.2 -I/usr/local/lib/glib/include
> < GTK_LIBRARIES=-L/usr/local/lib -lgtk -lgdk -lgmodule -lglib -lXext -lX11 -lm -lgdk_imlib
> ---
> > GTK_INCLUDES=-pthread -I/usr/local/include/gtk-1.2 -I/usr/local/include/glib-1.2 -I/usr/local/lib/glib/include
> > GTK_LIBRARIES=-L/usr/local/lib -lgtk -lgdk -lgmodule -lglib -lXext -lX11 -lm -lgdk_imlib -lungif -ltiff -pthread -Wl,-bbigtoc
> 
> 
> 
> Tom schulz
> Applied Dynamics Intl.
> schulz@adi.com
> 
> 


     Irene.
-----
Ir?ne Vatton                     INRIA Rh?ne-Alpes
INRIA                               ZIRST
e-mail: Irene.Vatton@inria.fr       655 avenue de l'Europe
Tel.: +33 4 76 61 53 61             Montbonnot
Fax:  +33 4 76 61 52 07             38334 Saint Ismier Cedex - France



