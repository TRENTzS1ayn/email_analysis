docno="lists-094-0510870"
received="Tue Feb  2 20:14:15 1999"
isoreceived="19990203011415"
sent="Tue, 2 Feb 1999 20:12:16 -0500 (EST)"
isosent="19990203011216"
name="Michal Jaegermann"
email="michal@ellpspace.math.ualberta.ca"
subject="amaya 1.4b on Linux/Alpha"
id="199902030112.SAA16223@ellpspace.math.ualberta.ca"
expires="-1"


To:www-amaya@w3.org


I tried to recompile amaya-1.4a on Linux/Alpha.  Instead of Motif I
used lesstif-0.86.5 ("fixed" version from the end of October 1998).
Amaya, in principle, compiles and works, after some patches, although
a list of compiler warnings (egcs-1.1.1) is extensive and a
substantial portion of these is quite justified.  This version is
a definite improvement in many areas over previous versions I tried
on the same platform.

One area which is totally broken is printing.   The first problem
is that all picture handlers contain a code like that (this one
is from xmbhandler.c):
    fprintf ((FILE *) fd, "gsave %d -%d translate\n",....
where 'fd' is declared as int.   Whatever originally opened this 'fd'
the net effect is that we lost half on an address and amaya tries
to scribble over a random memory.  It creates some subdirectories
in /tmp, with some skeleton files in them, but that is about it.
As these handlers are called through some jump tables it is not
immediately clear what else would be affected by a fix.

A code like that (this one is from Thot/thotlib/editing/applicationapi.c)
      i = (int) (oldptr) - (int) (text);      /* the length of the
                                                 directory part */
also does not have to end up with the same result as a correct
(in a hope that the result will indeed fit into int, but this is
likely the case):
      i = (int) (oldptr - text);

Amaya still ends up with "fatal error" when looking on some web pages
but this does not happen very often I do not have a good handle on
that.  These may be errors in an underlying lesstif libraries as well.

If somebody wants to look at my patches and a collection of compiler
warnings please send me an email.

  Michal
  michal@harddata.com

p.s. I am not a subscriber on this list



