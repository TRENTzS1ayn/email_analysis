docno="lists-096-10533675"
received="Wed Oct  1 06:51:33 2003"
isoreceived="20031001105133"
sent="Wed, 1 Oct 2003 12:51:08 +0200"
isosent="20031001105108"
name="Irene Vatton"
email="irene.vatton@inrialpes.fr"
subject="Re: RedHat RPM issues with amaya 8.1b"
id="20031001125108.55e42f78.irene.vatton@inrialpes.fr"
charset="ISO-8859-1"
inreplyto="Pine.LNX.4.44.0309301115210.3145-100000&#64;seasick.merl.com"
expires="-1"

To: Nico Kadel-Garcia<nkadel@merl.com>
Cc:www-amaya@w3.org



On Tue, 30 Sep 2003 11:37:40 -0400 (EDT)
Nico Kadel-Garcia <nkadel@merl.com> wrote:

> 
> 
> Overall, Amaya is a nice freeware tool. However, the .spec files
> included with it need some work as described below.
> 
> 1: amaya.spec refers to the wrong version of amaya and
> prevents the "rpmbuild -ta amaya-src-8.1b.tar.gz" from working. (I've
> got a patched .spec for this).

amaya.spec generates the motif version. We didn't generate this version for a
long time and I agree the file amaya.spec was not updated.
We have an amayagtk.spec that generates the gtk version and an amayagl.spec
that generates the gl version.

> 2: The "rm -f /usr/bin/amaya" in the compilation stages of the
> amaya.spec is completely inappropriate and should go the way of the
> Dodo. That's a %post and %postun behavior, not a compilation
> step. (I've got a patched .spec for this).

Yes, amaya.spec is not up to date.

> 3: The "cd linux; ../configure" step should occur in the
> "%setup" phase, not in the "%make" phase.  This will enable the use of
> "rpmbuild -bp" for debugging.) (I've got a patched .spec for this).

Okay.

> 4: There are a bunch of non-relevant differences between the
> ..spec files and commented out old steps. They should be flushed. (I've
> got a patched .spec for this).

Okay.

> 5: The .spec files use "--exec" instead of "--exec-prefix" for
> the "%make" options. This is a clear error and results in installing
> the Amaya binaries on the local system instead of the RPM pre-build
> locations, and can over-write current installations. (I've got a
> patched .spec for this).

See point 2.

> 6: %changelog is usually last in the .spec files. (I've got a
> patched .spec for this).

Okay.

> 7: Some of the spec files are noted as including the amayadoc
> tarball. Should this be re-integrated into the .spec, or is the
> documentation in the source tarball include a recent enough version of
> amayadoc? There are lots of differences between amayadoc's contents
> and the Amaya/doc files, so I can't assess easily which should be
> used.

The source tarball includes the English version of the documentation.
The tarball amayadoc includes French, Spanish, German, and in the future
Russian versions of the documentation.
Probably we'll have to generate a separate rpm.

> 8: The source tarball insists on including the redland and
> libwww tarballs as well. This goes against the basic idea of modular
> RPM compilation and installation. There are good RPM's available for
> both redland and libwww, and I don't see why you insist on including
> it in the source tarball for amaya.  (I won't pursue this unless
> others want it.)

Amaya uses standard libraries when it's possible, but it needs
specific versions of libwww, redland and expat.

> 9: Compilation for "gl" and "gtk" versions could be done as a
> ..spec option, rather than using. This would allow "rpmbuild -ta"
> compilation with a build-time flag set, and only one .spec file to
> maintain. (I won't pursue this unless others want it.)

This is probably a good idea but I'm not enough expert in rpmbuild 
to do that. Any patch available?

> 10: Because Amaya is system dependent set of binaries and
> configuration files and *NOT* a sharable set of tools, with its own
> documentation and libraries not integrated into
> "/usr/local/{lib,bin,include,share}" compilation, I think it should
> really be in "/opt", not in "/usr/share". But that's a matter of
> taste. (I won't pursue this unless others want it.)

This was due to the history. We installed several versions of Amaya
on the same server. All these versions were able to share 
configuration files and documentation.
It's still possible but it's not the current approach.

> If you want them, I'd be happy to submit my patched .spec files to
> you.

Yes please, send us your patches.

> amaya_gl compilation is still failing for RedHat 8.0, but I'm
> looking into that now.

We already generated the gl version on RedHat 8.0 with amayagl.spec.

> -- 
> 
> Nico Kadel-Garcia
> System and Networks Administrator
> Mitsubish Electric Research Lab
> <nkadel@merl.com>


     Irene.
-----
Ir?ne Vatton                     INRIA Rh?ne-Alpes
INRIA                               ZIRST
e-mail: Irene.Vatton@inria.fr       655 avenue de l'Europe
Tel.: +33 4 76 61 53 61             Montbonnot
Fax:  +33 4 76 61 52 07             38334 Saint Ismier Cedex - France



