docno="lists-096-13632883"
received="Wed Jan 28 05:48:08 2004"
isoreceived="20040128104808"
sent="Wed, 28 Jan 2004 12:48:12 +0200"
isosent="20040128104812"
name="Stanimir Stamenkov"
email="stanio@myrealbox.com"
subject="Re: Amaya and winnt\profiles (fwd)"
id="4017936C.9090800@myrealbox.com"
charset="us-ascii"
inreplyto="Amaya and winnt\profiles (fwd)"
expires="-1"


To:www-amaya@w3.org


> We're using semi-hardcoded paths. We're using the Win32 GetUserName()
> and GetWindowsDirectory() system calls to build the path 
> to the profiles directory.

Please, use the following functions to obtain the user profile 
directory:

<http://msdn.microsoft.com/library/en-us/policy/policy/profiles_directory.asp>:

> To obtain the location of a particular user's directory, call the 
> GetUserProfileDirectory function.
> [...]
> 
> To obtain the location of subdirectories of these directories, use 
> the SHGetFolderPath function.

One could use GetUserProfileDirectory adding "Application 
Data\Amaya" or just "amaya" which works for WinNT/2000/XP or better 
use SHGetSpecialFolderPath[1] with CSIDL_APPDATA parameter adding 
"Amaya" which should work for all Windows versions past Win95/NT4 
with IE 4 installed.

[1] 
http://msdn.microsoft.com/library/en-us/shellcc/platform/shell/reference/functions/shgetspecialfolderpath.asp

-- 
Stanimir



