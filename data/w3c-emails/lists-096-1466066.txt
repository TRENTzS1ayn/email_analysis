docno="lists-096-1466066"
received="Fri Dec 13 09:04:11 2002"
isoreceived="20021213140411"
sent="Fri, 13 Dec 2002 15:03:30 +0100"
isosent="20021213140330"
name="Jose Kahan"
email="jose.kahan@w3.org"
subject="Re: Internal graphics libs problems"
id="20021213140330.GK1033@inrialpes.fr"
charset="us-ascii"
inreplyto="1039780228.2406.36.camel&#64;David"
expires="-1"

To: Bill Hartwell<Anpwhotep@confederatelinux.com>
Cc:www-amaya@w3.org


Hello Bill,

Thanks for your report. It helped me understand what was wrong.
The problem is that I was misled by the way the imlib is compiled
under Debian.

In Debian, imlib already includes dynamic links to many graphic
libraries, including libjpeg, libz, and libpng. Here's the ldd on my 
amaya binary, compiled with the same rules you used:

---
$ ldd amaya
libgtk-1.2.so.0 => /usr/lib/libgtk-1.2.so.0 (0x4001b000)
libgdk-1.2.so.0 => /usr/lib/libgdk-1.2.so.0 (0x40140000)
libgmodule-1.2.so.0 => /usr/lib/libgmodule-1.2.so.0 (0x40175000)
libglib-1.2.so.0 => /usr/lib/libglib-1.2.so.0 (0x40178000)
libdl.so.2 => /lib/libdl.so.2 (0x4019b000)
libXi.so.6 => /usr/X11R6/lib/libXi.so.6 (0x4019e000)
libXext.so.6 => /usr/X11R6/lib/libXext.so.6 (0x401a6000)
libX11.so.6 => /usr/X11R6/lib/libX11.so.6 (0x401b3000)
libm.so.6 => /lib/libm.so.6 (0x4028d000)
libgdk_imlib.so.1 => /usr/lib/libgdk_imlib.so.1 (0x402ae000)
libXt.so.6 => /usr/X11R6/lib/libXt.so.6 (0x402d6000)
libXp.so.6 => /usr/X11R6/lib/libXp.so.6 (0x40320000)
libSM.so.6 => /usr/X11R6/lib/libSM.so.6 (0x40327000)
libICE.so.6 => /usr/X11R6/lib/libICE.so.6 (0x4032f000)
libc.so.6 => /lib/libc.so.6 (0x40345000)
libjpeg.so.62 => /usr/lib/libjpeg.so.62 (0x40462000)
libpng.so.2 => /usr/lib/libpng.so.2 (0x40481000)
libz.so.1 => /usr/lib/libz.so.1 (0x404ac000)
libtiff.so.3 => /usr/lib/libtiff.so.3 (0x404bc000)
libungif.so.4 => /usr/lib/libungif.so.4 (0x404fe000)
/lib/ld-linux.so.2 => /lib/ld-linux.so.2 (0x40000000)

--

This is surely different under Redhat. In addition, this is a bug
in our configure script. If Amaya is making explicit calls to those
libraries, it should link to them, and not try to assume that they
will arrive by magic from somewhere else.

I fixed this problem in the configure script so that it always 
includes those libraries. I already commited those changes.

I'm attaching both the configure and configure.in files. Just copy
them on the ~/Amaya directory and make 
  chmod +x configure
 to make it executable. If you manage to produce the RPM without
 problems, we'll make a new source tar ball and upload it.

 Thanks again for your help,

 -jose

On Fri, Dec 13, 2002 at 04:50:29AM -0700, Bill Hartwell wrote:
> 
> It doesn't look that way. I've tried compiling every which way but
> loose, but always end up bailing on the same thing, even when I added
> the --with-gtk and --without-graphic-libs switches on configure in the
> spec file. Does the new release require a more recent version of libpng
> than 1.0.14, or a more recent version of libjpeg than 6b? I've attached
> the errors that I get on every attempt to compile, along with the last
> command issued before the compiler exits. Hopefully this will help
> whoever's working on that part of the project to figure out what's the
> cause.
> 
> I also discovered that trying to compile the way I have previous
> releases, by extracting the tarball, making a linux subdirectory,
> changing to the subdirectory, and issuing a ../configure --with-gtk
> gives me an immediate response of:
> configure: error: can not find sources in .. or ..
> 
> So unless I can get the rpm to build, I'm not going to be able to
> install this version on my system.




text/plain attachment: configure

text/plain attachment: configure.in




