docno="lists-096-6092581"
received="Wed Jan 29 09:57:08 2003"
isoreceived="20030129145708"
sent="Wed, 29 Jan 2003 15:57:01 +0100"
isosent="20030129145701"
name="Jose Kahan"
email="jose.kahan@w3.org"
subject="Re: can't open amaya in winXP - other users"
id="20030129145701.GC490@inrialpes.fr"
charset="us-ascii"
inreplyto="b0jbqh$rpj$1&#64;main.gmane.org"
expires="-1"

To: Maur?cio<briqueabraque@yahoo.com>
Cc:www-amaya@w3.org



Mauricio,

Thanks for the tip. I looked at the code and tried it. However, there's
a problem. It doesn't work on all the platforms. 

For using this function, you need to download a SDK update from Microsoft.
And it may be that users need to apply a SP to their system to have the
latest version of the userenv.dll library. The one we have in our NT box
doesn't support this function. This seems like a lots of pain :-/

While waiting to resolve this, I'll comment the code I wrote and
add an extra search to the "Documents and Settins" directory. If it's
there, we'll consider the user dir to be around there.

BTW, I'm not sure if the first parameter can be NULL. The documentation
said otherwise. I'm confused.

-jose

On Tue, Jan 21, 2003 at 06:45:52AM -0500, Maur?cio wrote:
> 
>   I think I found what you want. Try GetUserProfileDirectory 
> (http://msdn.microsoft.com/library/default.asp?url=/library/en-us/policy/policy/getuserprofiledirectory.asp). 
> Use the parameter hToken as NULL.



