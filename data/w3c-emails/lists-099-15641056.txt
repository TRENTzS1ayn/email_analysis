docno="lists-099-15641056"
received="Fri Mar 19 02:37:30 2004"
isoreceived="20040319073730"
sent="Fri, 19 Mar 2004 08:37:03 +0100"
isosent="20040319073703"
name="Bjoern Hoehrmann"
email="derhoermi@gmx.net"
subject="genxScrubText(...) does not scrub text"
id="4065a066.478281322@smtp.bjoern.hoehrmann.de"
charset="us-ascii"
expires="-1"

To:tbray@textuality.com
Cc:www-archive@w3.org



Hi Tim,

  genxScrubText(...) does not work as advertised, it will never skip any
invalid octet sequence because it does not increment or reset the 'last'
pointer. I guess it is actually supposed to do something like

  ...
  while (*in)
  {
    int c = genxNextUnicodeChar(&in);
    if (c == -1 || !isXMLChar(w, c))
    {
      problems++;
      last = in; /* <-- */
      continue;
    }

    while (last < in)
      *out++ = *last++;
  }
  ...

regards.



