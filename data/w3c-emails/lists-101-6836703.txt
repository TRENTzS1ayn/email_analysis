docno="lists-101-6836703"
received="Tue Feb 12 00:18:13 2002"
isoreceived="20020212051813"
sent="Mon, 11 Feb 2002 23:17:58 -0600"
isosent="20020212051758"
name="Curt Arnold"
email="carnold@houston.rr.com"
subject="Xerces 2 failure on cdatasectionnormalize"
id="002201c1b384$a5f0ef10$a800a8c0@CurtMicron"
charset="iso-8859-1"
expires="-1"


To:<www-dom-ts@w3.org>

Appears to be a bug below in Xerces 2 below the DOM Parser.  When building an element from:
<name>Martha Raynolds<![CDATA[This is a CDATASection with EntityReference number 2 &ent2;]]>
<![CDATA[This is an adjacent CDATASection with a reference to a tab &tab;]]></name>

the element will have the correct number of child nodes (4), a text node containing "Martha Raynolds", a CDATASection node containing "This is ... &ent2;", a text node containing a new line and a last CDATASection.  However, instead of containing "This is... &tab;", it contains "This is ... &ent2;This is .. &tab;"  I assume this is due to a StringBuffer (or comparable) somewhere lower in Xerces that wasn't reset.

We should add additional tests for normalize in the next phase, since the existing tests start out with a loaded document which at least Xerces constructs normalized.  To really test normalize(), you would have to explicitly create an unnormalized document by creating and adding adjacent text nodes or other unnormalized features.



