docno="lists-104-10566709"
received="Tue Sep 17 08:03:08 2002"
isoreceived="20020917120308"
sent="Tue, 17 Sep 2002 14:02:28 +0200"
isosent="20020917120228"
name="Eric.Reiter@ic.lu"
email="Eric.Reiter@ic.lu"
subject="ReplaceData"
id="57D5A4DAAEA0D611AFEE00D0B7DBA2F9392A85@PRIMERGY_02"
charset="iso-8859-1"
expires="-1"


To:www-dom@w3.org


Hello

I would like to replace data in an XML node from an HTML form.

Here is my XML file:
----------------------------------------------------------------------
<suivi>
<part>
<entree>
......
</entree>
<entree>
.......
</entree>
<entree>
<jour>4. JES05.09.02</jour>
<tk>32400</tk>
<typdoc>
</typdoc>
<lgmod>
</lgmod>
<resplay>ere</resplay>
<page>40</page>
<langue>IT</langue>
<render>
</render>
<is></is>
<remarque></remarque>
</entree>
</part>
</suivi>
----------------------------------------------------------------------------
------

Here is my script :
----------------------------------------------------------------------------
-----
function modiflg(){
tkCible=document.form1.tk.value;
newlg=document.form1.lgmod.value;
confirmation=confirm("Voulez-vous r?ellement modifier la langue mod?le de la
TK  "+tkCible+"?")
if (confirmation==true){
var xmlDoc = new ActiveXObject("MSXML.DOMDocument");
var oSelection;
xmlDoc.setProperty("SelectionLanguage", "XPath");
xmlDoc.async = false;
xmlDoc.load("suivi.xml");
oSelection = selectNodes("//entree[child::tk='"+tkCible+"']/lgmod");
oSelection.replaceData(0,2,newlg);
xmlDoc.save("suivi.xml");
alert ("Langue mod?le pour "+tkCible+" modifi?e");}
else{alert(tkCible+" n'a pas ?t? modifi?e")}
}
----------------------------------------------------------------------------
-------------------

Unfortunatunately, it doesn't work. Can someone, please, help me?
Thanks
Eric



