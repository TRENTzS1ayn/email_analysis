docno="lists-104-3703337"
received="Fri Nov  9 11:48:24 2001"
isoreceived="20011109164824"
sent="Fri, 9 Nov 2001 09:47:00 -0700 "
isosent="20011109164700"
name="Arnold, Curt"
email="Curt.Arnold@hyprotech.com"
subject="RE: encoding ignored in MSXML Load method"
id="70E215722F6AD511820A000103D141D40AA673@thor.aeathtl.com"
inreplyto="encoding ignored in MSXML Load method"
expires="-1"


To:"'Tim'"<tfraser@miray.jeffsys.net>
Cc:"'www-dom@w3.org'"<www-dom@w3.org>

The Microsoft.public.xml newsgroup (assessible through
http://msdn.microsoft.com) would be the appropriate forum.  This mailing
list is for issues with the DOM recommendations, not a particular
implementation.

loadXML is a Microsoft extension that reads the xml document from a string,
not from a file.  Since all strings in COM are defined to be in UTF-16, any
residual encoding declaration is ignored.  For example,

xmlFO.loadXML "<foo/>"

Or

xmlFO.loadXML "<?xml version="1.0" encoding="US-EBCDIC"><foo/>"

result in the same document element.

Debug.Print is using a serialization routine in the DOM to generate the
string representation of the DOM.  The encoding does appear to be recognized
since the document isn't garbage.  However, since it is serializing the
document to a string and strings are defined as UTF-16, the serializer does
not need to specify an encoding.



